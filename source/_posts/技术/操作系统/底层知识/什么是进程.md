---
date: 2021-04-13 17:48:42
updated: 2021-04-13 17:48:42
title: 什么是线程
index_img: /gallery/2021-08-23-20-13-43.png

tags:
  - System

categories:
  - System

---

# 设计知识

- [堆栈]
- [上下文]
- [进程控制块]

# 什么是线程

- 狭义定义：进程是正在运行的程序的实例
- 广义定义：是操作系统动态执行的基本单元，在传统的操作系统中，进程既是基本的分配单元，也是基本的执行单元

```vim
进程就是计算题分派资源的最小单位,进程都有它自己的地址空间
进程是一个“执行中的程序”。程序是一个没有生命的实体，只有处理器赋予程序生命时（操作系统执行之），它才能成为一个活动的实体，我们称其为进程
```

## 内容

- 一个计算机系统进程包括（或者说“拥有”）下列数据
  - 那个程序的可运行机器码的一个在存储器的映像
  - 分配给该进程的资源的操作系统描述符，诸如文件描述符（Unix 术语）或文件句柄（Windows）
  - 处理器状态（内文），诸如寄存器内容、物理存储器寻址等。当进程正在运行时，状态通常储存在寄存器，其他情况在存储器。
- 切换
  - 进行进程切换就是从正在运行的进程中收回处理器，然后再使待运行进程来占用处理器。
  - 实质上就是把进程存放在处理器的寄存器中的中间数据找个地方存起来
  - 从而把处理器的寄存器腾出来让其他进程使用
  - 被终止的进程的上下文数据存放到进程的私有[堆栈]
  - 让进程来占用处理器，就是把进程的私有堆栈的内容复制到 CPU 寄存器,然后把之前的断点放到 PC(程序计数器)中,这时候就是 CPU 正在运行这个程序
  - 切换的额时候一个进程存储在各个寄存器中的数据叫做[上下文],所以在进程处于就绪状态的时候,上下文是在私有堆栈中的
- 状态
  - 进程执行时的间断性，决定了进程可能具有多种状态。事实上，运行中的进程可能具有以下三种基本状态。
  - 1）就绪状态（Ready）：
    - 就是进程已经获取处理去外的所有资源(硬盘,文件...),处于等待处理器资源,只要分配处理器就可以执行
    - 就绪进程可以按多个优先级来划分队列,例如，当一个进程由于时间片用完而进入就绪状态时，排入低优先级队列；当进程由 I/O 操作完成而进入就绪状态时，排入高优先级队列。
  - 2）运行状态(Running)：
    - 进程占用处理器资源；处于此状态的进程的数目小于等于处理器的数目。在没有其他进程可以执行时(如所有进程都在阻塞状态)，通常会自动执行系统的空闲进程。
  - 3）阻塞状态(Blocked)：
    - 由于进程等待某种条件（如 I/O 操作或进程同步），在条件满足之前无法继续执行。该事件发生前即使把处理器资源分配给该进程，也无法运行。

## 和一些概念的区别

- 程序
  - 程序是指令和数据的有序集合，其本身没有任何运行的含义，**是一个静态的概念**。而进程是程序在处理机上的一次执行过程，**它是一个动态的概念**。
  - **程序可以作为一种软件资料长期存在**，而进程是有一定生命期的。程序是永久的，**进程是暂时的**。
  - 进程更能真实地描述并发，而程序不能；
  - 进程是由[进程控制块]、[程序段]、数据段三部分组成;
  - 进程具有创建其他进程的功能，而程序没有。
  - 在传统的操作系统中，**程序并不能独立运行**，作为资源分配和独立运行的**基本单元都是进程**。

---

- [线程]
  - 通常在一个进程中**可以包含若干个线程**，它们**可以利用进程所拥有的资源**
  - 在引入线程的操作系统中，通常都是把进程作为分配资源的基本单位，而把线程作为独立运行和独立调度的基本单位
  - 由于**线程比进程更小**，基本上不拥有系统资源，故对它的调度**所付出的开销就会小得多**，能更高效的提高系统内多个程序间并发执行的程度
  - 当下推出的通用操作系统都引入了线程，以便进一步提高系统的并发性
