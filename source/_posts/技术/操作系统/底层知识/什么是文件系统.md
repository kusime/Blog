---
date: 2021-03-19 15:47:10
updated: 2021-03-19 15:47:10
title: 什么是文件系统
index_img: /gallery/2021-08-23-20-13-43.png

tags:
  - System

categories:
  - System

---

- [文件系统基本介绍](#文件系统基本介绍)
- [知识扩展](#知识扩展)
  - [簇](#簇)
- [常用格式的介绍](#常用格式的介绍)
  - [FAT](#fat)
    - [为什么 UEFI 文件系统格式必须为 FAT](#为什么-uefi-文件系统格式必须为-fat)
  - [NTFS](#ntfs)
  - [exFAT](#exfat)
  - [RAW](#raw)
  - [Ext](#ext)
    - [Ext2](#ext2)
    - [Ext3](#ext3)
    - [Ext4](#ext4)

# 文件系统基本介绍

- 文件系统是操作系统用于明确存储设备或分区上的文件的方法和数据结构，即在存储设备上组织文件的方法。
- 文件系统由三部分组成
  - 文件系统的接口
  - 对对象操纵和管理的软件集合
  - 对象及属性
- 从系统角度来看
  - 文件系统是对文件存储设备的空间进行组织和分配
  - 负责文件存储并对存入的文件进行保护和检索的系统
  - 它负责为用户建立文件，存入、读出、修改、转储文件，控制文件的存取，当用户不再使用时撤销文件等。

# 知识扩展

## 簇

- 微软操作系统（DOS、WINDOWS 等）中磁盘文件存储管理的最小单位叫做“簇”
- 簇（CLUST）的本意就是“一群”、“一组”，即一组扇区
- 因为扇区的单位太小，因此把它捆在一起，组成一个更大的单位更方便进行灵活管理
- 簇的大小通常是可以变化的，是由操作系统在所谓“（高级）格式化”时规定的，因此管理也更加灵活。
- 通俗地讲文件就好比是一个家庭，数据就是人，即家庭成员；所谓簇就是一些单元套房；
- 扇区是组成这些单元套房的一个个大小相等的房间

# [常用格式的介绍](https://baike.baidu.com/item/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/4827215)

## FAT

- FAT16 支持的分区最大为 2GB
- 使用的簇越小，保存信息的效率就越高
- 在 FAT16 的情况下，分区越大簇就相应的要大，存储效率就越低，势必造成存储空间的浪费
- 并且随着计算机硬件和应用的不断提高，FAT16 文件系统已不能很好地适应系统的要求。在这种情况下，推出了增强的文件系统 FAT32
- FAT32 主要具有以下特点
  - 同 FAT16 相比 FAT32 最大的优点是可以支持的磁盘大小达到 32GB，但是不能支持小于 512MB 的分区
  - 由于采用了更小的簇，FAT32 文件系统可以更有效率地保存信息
  - FAT32 文件系统可以重新定位根目录和使用 FAT 的备份副本

### [为什么 UEFI 文件系统格式必须为 FAT](https://zhuanlan.zhihu.com/p/25992179)

- UEFI 规定 UEFI 系统分区 EFI system partition (ESP)采用 FAT32 格式，同时支持 FAT12/FAT16 作为移动介质的文件系统
- UEFI 的 FAT 分区和普通的 FAT 分区有个比较小的区别，即 OSType 不同。ESP 在 GPT（不再本文范围内）分区表中有个特殊的 GUID:
- ESP 对 UEFI 启动很重要，UEFI 的操作系统引导程序是以后缀名为.efi 的文件存放在 ESP 分区中的
- 启动操作系统本质上就是运行 ESP 分区内的 app：bootloader 而已
- UEFI 分区内仅仅存储各种 bootloader 和 BIOS 错误恢复程序，操作系统和数据本身是不放在这里的，完全没有问题。

## NTFS

- NTFS 文件系统是一个基于安全性的文件系统，是 Windows NT 所采用的独特的文件系统结构，它是建立在保护文件和目录数据基础上，同时照顾节省存储资源、减少磁盘占用量的一种先进的文件系统。
- NTFS 可以支持的 MBR 分区（如果采用动态磁盘则称为卷）最大可以达到 2TB，GPT 分区则无限制。而 Win 2000 中的 FAT32 支持单个文件的大小最大为 2GB。
- NTFS 是一个可恢复的文件系统。在 NTFS 分区上用户很少需要运行磁盘修复程序。NTFS 通过使用标准的事物处理日志和恢复技术来保证分区的一致性。发生系统失败事件时，NTFS 使用日志文件和检查点信息自动恢复文件系统的一致性。

## exFAT

- 全称 Extended File Allocation Table File System，扩展 FAT
- 是 Microsoft 在 Windows Embeded 5.0 以上（包括 Windows CE 5.0、6.0、Windows Mobile5、6、6.1）中引入的一种适合于闪存的文件系统，为了解决 FAT32 等不支持 4G 及其更大的文件而推出
- 对于闪存，NTFS 文件系统不适合使用，exFAT 更为适用。相对 FAT 文件系统，exFAT 有如下好处：

## RAW

- RAW 文件系统是一种磁盘未经处理或者未经格式化产生的文件系统
  - ● 没有格式化。
  - ● 格式化中途取消操作。
  - ● 硬盘出现坏道。
  - ● 硬盘出现不可预知的错误。
  - ● 病毒所致。

## Ext

### Ext2

- 其特点为存取文件的性能极好，对于中小型的文件更显示出优势，这主要得利于其簇快取层的优良设计。
- 其单一文件大小与文件系统本身的容量上限与文件系统本身的簇大小有关，
  - 簇最大为 4KB，则单一文件大小上限为 2048GB，而文件系统的容量上限为 16384GB。
- 但由于目前核心 2.4 所能使用的单一分割区最大只有 2048GB，实际上能使用的文件系统容量最多也只有 2048GB。

### Ext3

- 由于文件系统都有快取层参与运作，如不使用时必须将文件系统卸下
- Ext3 是一种日志式文件系统，是对 ext2 系统的扩展，它兼容 ext2。
- 如果在文件系统尚未 shutdown 前就关机 （如停电） 时，下次重开机后会造成文件系统的资料不一致，故这时必须做文件系统的重整工作，将不一致与错误的地方修复。然而，此一重整的工作是相当耗时的，特别是容量大的文件系统，而且也不能百分之百保证所有的资料都不会流失。
- 为了克服此问题，使用所谓‘日志式文件系统(Journal File System) ’。此类文件系统最大的特色是，它会将整个磁盘的写入动作完整记录在磁盘的某个区域上，以便有需要时可以回溯追踪。
- 由于资料的写入动作包含许多的细节，像是改变文件标头资料、搜寻磁盘可写入空间、一个个写入资料区段等等，每一个细节进行到一半若被中断，就会造成文件系统的不一致，因而需要重整。

### Ext4

- Linux kernel 自 2.6.28 开始正式支持新的文件系统 Ext4。
- Ext4 是 Ext3 的改进版，修改了 Ext3 中部分重要的数据结构，而不仅仅像 Ext3 对 Ext2 那样，只是增加了一个日志功能而已。
- Ext4 可以提供更佳的性能和可靠性，还有更为丰富的功能：
  - 与 Ext3 兼容。执行若干条命令，就能从 Ext3 在线迁移到 Ext4，而无须重新格式化磁盘或重新安装系统。原有 Ext3 数据结构照样保留，Ext4 作用于新数据，当然，整个文件系统因此也就获得了 Ext4 所支持的更大容量。
  - 更大的文件系统和更大的文件。较之 Ext3 目前所支持的最大 16TB 文件系统和最大 2TB 文件，Ext4 分别支持 1EB（1,048,576TB， 1EB=1024PB， 1PB=1024TB）的文件系统，以及 16TB 的文件。
