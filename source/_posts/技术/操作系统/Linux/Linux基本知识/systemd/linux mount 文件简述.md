---
date: 2021-03-24 21:05:06
updated: 2021-03-24 21:05:06
title: linux mount 文件简述
index_img: /gallery/2021-08-23-19-18-20.png
tags:
  - Linux

categories:
  - Linux
---

# Mount 单元

- 这个 mount 属于 systemd 中的一个单元文件，用于指定挂载点，实现自动挂载的

![error_loading](/gallery/2021-03-24-20-42-18.png)

- 基本的文件由
  - 基本段
  - Install 段 (次要)

# Mount 段

| 配置名字 | 解释                                        |
| -------- | ------------------------------------------- |
| Where    | 挂载点在哪里                                |
| What     | 文件系统是什么，这里可以理解为 /dev/sda1 等 |
| Type     | 文件系统的格式是什么                        |
| Options  | 挂载的选项是什么                            |

## Options

|         挂载选项         |                                                                                    解释                                                                                     |
| :----------------------: | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
|         \_netdev         |                                          通常根据文件系统的类型来判断是否为网络文件系统， 以决定是否必须在网络可用之后才能启动[^1]                                          |
|          noauto          |                                  noauto 表示不将此挂载点加入到 local-fs.target/remote-fs.target 的依赖中， 也就是不在系统启动时自动挂载,而                                  |
|           auto           |                                                         默认值 auto 则表示自动将此挂载点加入到上述目标单元的依赖中                                                          |
|          nofail          |                                                                   在挂载失败时(比如设备不存在)直接跳过。                                                                    |
|   x-systemd.automount    | 同时创建一个对应的 automount 单元，表示在第一次对该文件系统进行访问时自动挂载。内核会将从触发自动挂载到挂载成功期间所有对该设备的访问缓冲下来，当挂载成功后再去访问该设备。 |
| x-systemd.mount-timeout  |                                                           对应的值为整数，用于决定挂载网络盘的超时时间，单位为 s                                                            |
|       idle-timeout       |                  这表示 systemd 如果发现该设备在 1 分钟内都处于 idle 状态，将自动卸载它。默认单位为秒，支持的单位有 s, min, h, ms，设置为 0 表示永不超时。                  |
| x-systemd.device-timeout |                                              表示等待该设备多长时间才认为可用于挂载(即判断该设备可执行挂载操作)，默认等待 90s                                               |

[^1]: 网络文件系统所对应的 mount 单元将被安排在 remote-fs-pre.target 与 remote-fs.target 之间启动(而不是在 local-fs-pre.target 与 local-fs.target 之间)， 并且自动获得 After=network-online.target, Wants=network-online.target, After=network.target 依赖。
[^2]: nofail 通常会结合 x-systemd.device-timeout 一起使用，表示等待该设备多长时间才认为可用于挂载(即判断该设备可执行挂载操作)，默认等待 90s，这意味着如果结合 nofail 时，如果挂载的设备不存在，将会卡顿 90s。默认单位为秒，支持的单位有 s, min, h, ms，设置为 0 表示永不超时。

# 关于 x-systemd.device-timeout 和 x-systemd.mount-timeout

![error_loading](/gallery/2021-03-25-15-09-43.png)

# 实例查看

```bash
# Automatically generated by systemd-fstab-generator

[Unit]
Documentation=man:fstab(5) man:systemd-fstab-generator(8)
SourcePath=/etc/fstab
Before=local-fs.target
After=blockdev@dev-disk-by\x2duuid-9df13d69\x2d2935\x2d4d85\x2dbe8c\x2d895ef97b3a06.target

[Mount]
Where=/
What=/dev/disk/by-uuid/9df13d69-2935-4d85-be8c-895ef97b3a06
Type=ext4
Options=errors=remount-ro #这里采用mount 格式选项
~
```
